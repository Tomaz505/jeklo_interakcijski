<html>
<head>
<HTA:APPLICATION
    ID="Analiza"
    APPLICATIONNAME="Analiza jeklenega prereza"
    BORDER="thin"
    SCROLL="yes"
    SINGLEINSTANCE="yes"
    WINDOWSTATE="normal"
/>
<title>Test HTA</title>
<script type="text/javascript">

function runFortran() {

    // Read inputs
    var analiza = document.getElementById("analiza").value;   // line 1
    var fy      = document.getElementById("fy").value;        // line 2
    var nsned   = document.getElementById("nsned").value;     // line 3 (e.g. 16,0)
    var geom    = document.getElementById("geom").value;      // line 4 (coords)
    var load    = document.getElementById("load").value;      // line 5 (e.g. 0,0,0)

    // Normalize geometry: remove newlines
    geom = geom.replace(/\r?\n/g, " ").trim();

    var fso = new ActiveXObject("Scripting.FileSystemObject");

    // Write in.txt EXACTLY like your sample
    var f = fso.CreateTextFile("in.txt", true);
    f.WriteLine(analiza);
    f.WriteLine(fy);
    f.WriteLine(nsned);
    f.WriteLine(geom);
    f.WriteLine(load);
    f.Close();

    alert("in.txt written. Now running main.exe ...");

    var shell = new ActiveXObject("WScript.Shell");
    // run main.exe in current folder, wait until finished
    shell.Run("\"" + fso.GetAbsolutePathName(".") + "\\main.exe\"", 0, true);

    alert("main.exe finished. Check out.js and in.txt in the folder.");
}

</script>
</head>

<body>
<h2>Test: pisanje in.txt in zagon main.exe</h2>

<p>Vnesi podatke točno tako, kot jih ima tvoj primer:</p>

<b>1. analiza (1 / 2 / 3):</b><br>
<input id="analiza" value="3"><br><br>

<b>2. fy:</b><br>
<input id="fy" value="1"><br><br>

<b>3. ns,ned (npr. 16,0):</b><br>
<input id="nsned" value="16,0"><br><br>

<b>4. Koordinate (ena vrstica ali več – pretvorimo v eno):</b><br>
<textarea id="geom" rows="4" cols="80">0,0, 10,0, 10,0.85, 5.88,0.85, 5.28,1.45, 5.28,18.55, 5.88,19.15, 10,19.15, 10,20, 0,20, 0,19.15, 4.12,19.15, 4.72,18.55, 4.72,1.45, 4.12,0.85, 0,0.85</textarea><br><br>

<b>5. Obtežba (npr. 0,0,0):</b><br>
<input id="load" value="0,0,0"><br><br>

<button onclick="runFortran()">Zapiši in.txt in zaženi main.exe</button>

</body>
</html>
